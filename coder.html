<!DOCTYPE html>
<html lang="zh-CN">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Monaco ä»£ç ç¼–è¾‘å™¨</title>
	<style>
		:root {
			color-scheme: dark;
		}

		@keyframes spin {
			0% {
				transform: rotate(0deg);
				opacity: 1;
			}

			100% {
				transform: rotate(360deg);
				opacity: 0.8;
			}
		}

		.loader-overlay {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: rgba(30, 30, 30, 0.8);
			display: flex;
			justify-content: center;
			align-items: center;
			z-index: 9999;
			transition: opacity 0.5s ease;
		}

		.loader {
			width: 10em;
			height: 10em;
			border-radius: 50%;
			background: conic-gradient(rgb(10, 182, 212) 0% 20%, rgba(0, 0, 0, 0) 20%);
			animation: spin 1s linear infinite;
			box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
		}

		.hljs.language-html::before,
		.hljs.language-xml::before {
			content: "HTML/XML"
		}

		.hljs.language-javascript::before {
			content: "JavaScript"
		}

		.hljs.language-c::before {
			content: "C"
		}

		.hljs.language-cpp::before {
			content: "C++"
		}

		.hljs.language-java::before {
			content: "Java"
		}

		.hljs.language-asp::before {
			content: "ASP"
		}

		.hljs.language-actionscript::before {
			content: "ActionScript/Flash/Flex"
		}

		.hljs.language-bash::before {
			content: "Bash"
		}

		.hljs.language-css::before {
			content: "CSS"
		}

		.hljs.language-asp::before {
			content: "ASP"
		}

		.hljs.language-cs::before,
		.hljs.language-csharp::before {
			content: "C#"
		}

		.hljs.language-d::before {
			content: "D"
		}

		.hljs.language-golang::before,
		.hljs.language-go::before {
			content: "Go"
		}

		.hljs.language-json::before {
			content: "JSON"
		}

		.hljs.language-lua::before {
			content: "Lua"
		}

		.hljs.language-less::before {
			content: "LESS"
		}

		.hljs.language-md::before,
		.hljs.language-markdown::before,
		.hljs.language-mkdown::before,
		.hljs.language-mkd::before {
			content: "Markdown"
		}

		.hljs.language-mm::before,
		.hljs.language-objc::before,
		.hljs.language-obj-c::before,
		.hljs.language-objective-c::before {
			content: "Objective-C"
		}

		.hljs.language-php::before {
			content: "PHP"
		}

		.hljs.language-perl::before,
		.hljs.language-pl::before,
		.hljs.language-pm::before {
			content: "Perl"
		}

		.hljs.language-python::before,
		.hljs.language-py::before,
		.hljs.language-gyp::before,
		.hljs.language-ipython::before {
			content: "Python"
		}

		.hljs.language-r::before {
			content: "R"
		}

		.hljs.language-ruby::before,
		.hljs.language-rb::before,
		.hljs.language-gemspec::before,
		.hljs.language-podspec::before,
		.hljs.language-thor::before,
		.hljs.language-irb::before {
			content: "Ruby"
		}

		.hljs.language-sql::before {
			content: "SQL"
		}

		.hljs.language-sh::before,
		.hljs.language-shell::before,
		.hljs.language-Session::before,
		.hljs.language-shellsession::before,
		.hljs.language-console::before {
			content: "Shell"
		}

		.hljs.language-swift::before {
			content: "Swift"
		}

		.hljs.language-vb::before {
			content: "VB/VBScript"
		}

		.hljs.language-yaml::before {
			content: "YAML"
		}

		.hljs,
		.math-block {
			border-radius: 1em;
			position: relative;
			display: block;
			overflow-x: hidden;
			color: #d4d4d4;
			padding-top: 30px !important;
			box-shadow: 0 10px 30px 0px rgb(0 0 0 / 40%)
		}

		#preview .math-block::before {
			content: "Math"
		}

		.hljs::before,
		.math-block::before {
			content: "";
			position: absolute;
			left: 15px;
			top: 10px;
			overflow: visible;
			width: 12px;
			height: 12px;
			border-radius: 16px;
			box-shadow: 20px 0 #fdbc40, 40px 0 #35cd4b;
			-webkit-box-shadow: 20px 0 #fdbc40, 40px 0 #35cd4b;
			background-color: #fc625d;
			white-space: nowrap;
			text-indent: 75px;
			font-size: 16px;
			line-height: 12px;
			font-weight: 700;
		}

		body {
			margin: 0;
			padding: 0;
			font-family: Arial, sans-serif;
			display: flex;
			flex-direction: column;
			height: 100vh;
			overflow: hidden;
			background-color: #1e1e1e;
			color: #d4d4d4;
		}

		.header {
			background-color: #252526;
			color: #d4d4d4;
			padding: 10px 20px;
			display: flex;
			justify-content: space-between;
			align-items: center;
			border-bottom: 1px solid #1e1e1e;
		}

		.title {
			font-size: 20px;
			font-weight: bold;
		}

		.controls {
			display: flex;
			gap: 10px;
			align-items: center;
		}

		button,
		select,
		input {
			padding: 5px 10px;
			border-radius: 4px;
			border: none;
			background-color: #3c3c3c;
			color: #d4d4d4;
			cursor: pointer;
		}

		button:hover {
			background-color: #2a2d2e;
		}

		select {
			min-width: 120px;
		}

		input[type="number"] {
			width: 60px;
			-moz-appearance: textfield;
			appearance: textfield;
		}

		input[type="number"]::-webkit-outer-spin-button,
		input[type="number"]::-webkit-inner-spin-button {
			-webkit-appearance: none;
			margin: 0;
		}

		.editor-container {
			flex: 1;
			display: flex;
			background-color: #1e1e1e;
			height: 1vh;
		}

		#editor {
			width: 100%;
			height: 100%;
		}

		#preview {
			width: 50%;
			height: 100%;
			border: none;
			background-color: #1e1e1e;
			padding: 20px;
			overflow: auto;
			box-sizing: border-box;
			color: #d4d4d4;
		}

		.splitter {
			width: 5px;
			background-color: #252526;
			cursor: col-resize;
		}

		.status-bar {
			background-color: #252526;
			color: #858585;
			padding: 5px 10px;
			font-size: 12px;
			display: flex;
			justify-content: space-between;
			border-top: 1px solid #1e1e1e;
		}

		.theme-toggle {
			position: fixed;
			bottom: 20px;
			right: 10px;
			z-index: 100;
			background-color: #3c3c3c;
			color: #d4d4d4;
			border: none;
			border-radius: 50%;
			width: 40px;
			height: 40px;
			font-size: 20px;
			cursor: pointer;
			display: flex;
			align-items: center;
			justify-content: center;
			box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
		}

		.font-controls {
			display: flex;
			gap: 5px;
			align-items: center;
		}

		.font-controls label {
			font-size: 12px;
			margin-right: -5px;
		}

		.view-toggle {
			position: fixed;
			bottom: 70px;
			right: 10px;
			z-index: 100;
			background-color: #3c3c3c;
			color: #d4d4d4;
			border: none;
			border-radius: 50%;
			width: 40px;
			height: 40px;
			font-size: 20px;
			cursor: pointer;
			display: flex;
			align-items: center;
			justify-content: center;
			box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
		}

		.save-toggle {
			position: fixed;
			bottom: 120px;
			right: 10px;
			z-index: 100;
			background-color: #3c3c3c;
			color: #d4d4d4;
			border: none;
			border-radius: 50%;
			width: 40px;
			height: 40px;
			font-size: 20px;
			cursor: pointer;
			display: flex;
			align-items: center;
			justify-content: center;
			box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
		}

		/* Markdown é¢„è§ˆæ ·å¼ - æš—è‰²ä¸»é¢˜ */
		#preview h1,
		#preview h2,
		#preview h3,
		#preview h4,
		#preview h5,
		#preview h6 {
			margin-top: 1em;
			margin-bottom: 0.5em;
			font-weight: bold;
			color: #d4d4d4;
		}

		#preview h1 {
			font-size: 2em;
			border-bottom: 1px solid #333;
			color: #569cd6;
		}

		#preview h2 {
			font-size: 1.5em;
			border-bottom: 1px solid #333;
			color: #4ec9b0;
		}

		#preview h3 {
			font-size: 1.25em;
			color: #c586c0;
		}

		#preview h4 {
			font-size: 1em;
			color: #9cdcfe;
		}

		#preview h5 {
			font-size: 0.875em;
			color: #ce9178;
		}

		#preview h6 {
			font-size: 0.85em;
			color: #858585;
		}

		#preview p {
			margin: 0 0 1em;
			color: #d4d4d4;
		}

		#preview ul,
		#preview ol {
			margin: 0 0 1em 2em;
			padding: 0;
			color: #d4d4d4;
		}

		#preview li {
			margin: 0.25em 0;
			color: #d4d4d4;
		}

		#preview blockquote {
			margin: 0 0 1em;
			padding: 0 1em;
			border-left: 4px solid #6a9955;
			color: #d4d4d4;
			background-color: #252526;
		}

		#preview blockquote p {
			margin: 0;
		}

		#preview pre code,
		.math-block {
			background-color: #252526;
			padding: 1em;
			border-radius: 3px;
			overflow: auto;
			border: 1px solid #333;
		}

		#preview code,
		.math-block {
			font-family: Consolas, Monaco, monospace;
			background-color: #252526;
			padding: 0.2em 0.4em;
			border-radius: 3px;
			color: #d4d4d4;
		}

		#preview a {
			color: #569cd6;
			text-decoration: none;
		}

		#preview a:hover {
			text-decoration: underline;
		}

		#preview img {
			max-width: 100%;
			background-color: white;
			padding: 5px;
			border-radius: 3px;
		}

		#preview table {
			border-collapse: collapse;
			margin: 1em 0;
			width: 100%;
		}

		#preview th,
		#preview td {
			border: 1px solid #333;
			padding: 0.5em 1em;
			color: #d4d4d4;
		}

		#preview th {
			background-color: #252526;
			font-weight: bold;
		}

		#preview tr:nth-child(even) {
			background-color: #252526;
		}

		/* KaTeX å…¬å¼æ ·å¼ */
		.katex {
			font-size: 1.1em !important;
			color: #d4d4d4 !important;
		}

		/* æ•°å­¦å…¬å¼å—æ ·å¼ */
		.math-block {
			text-align: center;
			margin: 1em 0;
			padding: 0.5em;
			background-color: #252526;
			border-radius: 3px;
			overflow-x: auto;
		}

		/* Highlight.js ä¸»é¢˜ - ç±»ä¼¼ VS Code æš—è‰²ä¸»é¢˜ */
		.hljs,
		.math-block {
			display: block;
			overflow-x: auto;
			padding: 0.5em;
			background: #252526;
			color: #d4d4d4;
		}

		.hljs-keyword,
		.hljs-literal,
		.hljs-name,
		.hljs-symbol {
			color: #569cd6;
		}

		.hljs-link {
			color: #569cd6;
			text-decoration: underline;
		}

		.hljs-built_in,
		.hljs-type {
			color: #4ec9b0;
		}

		.hljs-number,
		.hljs-class {
			color: #b5cea8;
		}

		.hljs-string,
		.hljs-meta-string {
			color: #ce9178;
		}

		.hljs-regexp,
		.hljs-template-tag {
			color: #9a5334;
		}

		.hljs-subst,
		.hljs-function,
		.hljs-title,
		.hljs-params,
		.hljs-formula {
			color: #dcdcaa;
		}

		.hljs-comment,
		.hljs-quote {
			color: #6a9955;
			font-style: italic;
		}

		.hljs-doctag {
			color: #608b4e;
		}

		.hljs-meta,
		.hljs-meta-keyword,
		.hljs-tag {
			color: #9b9b9b;
		}

		.hljs-variable,
		.hljs-template-variable {
			color: #bd63c5;
		}

		.hljs-attr,
		.hljs-attribute,
		.hljs-builtin-name {
			color: #9cdcfe;
		}

		.hljs-section {
			color: gold;
		}

		.hljs-emphasis {
			font-style: italic;
		}

		.hljs-strong {
			font-weight: bold;
		}

		.hljs-bullet,
		.hljs-selector-tag,
		.hljs-selector-id,
		.hljs-selector-class,
		.hljs-selector-attr,
		.hljs-selector-pseudo {
			color: #d7ba7d;
		}

		.hljs-addition {
			background-color: #144212;
			display: inline-block;
			width: 100%;
		}

		.hljs-deletion {
			background-color: #600;
			display: inline-block;
			width: 100%;
		}
	</style>
	<style>
		.help-toggle {
			position: fixed;
			bottom: 170px;
			right: 10px;
			z-index: 100;
			background-color: #3c3c3c;
			color: #d4d4d4;
			border: none;
			border-radius: 50%;
			width: 40px;
			height: 40px;
			font-size: 20px;
			cursor: pointer;
			display: flex;
			align-items: center;
			justify-content: center;
			box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
		}

		.help-panel {
			position: fixed;
			bottom: 220px;
			right: 10px;
			width: 400px;
			max-height: 500px;
			background-color: #252526;
			border-radius: 8px;
			padding: 15px;
			box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
			z-index: 99;
			overflow-y: auto;
			display: none;
		}

		.help-panel h3 {
			color: #569cd6;
			margin-top: 0;
			border-bottom: 1px solid #333;
			padding-bottom: 5px;
		}

		.help-panel table {
			width: 100%;
			border-collapse: collapse;
			margin: 10px 0;
		}

		.help-panel th,
		.help-panel td {
			border: 1px solid #333;
			padding: 8px;
			text-align: left;
		}

		.help-panel th {
			background-color: #1e1e1e;
		}

		.help-panel code {
			background-color: #1e1e1e;
			padding: 2px 4px;
			border-radius: 3px;
		}

		/* æ–°å¢çš„è®¾ç½®æ¨¡æ€æ ·å¼ */
		.settings-toggle {
			position: fixed;
			bottom: 220px;
			right: 10px;
			z-index: 100;
			background-color: #3c3c3c;
			color: #d4d4d4;
			border: none;
			border-radius: 50%;
			width: 40px;
			height: 40px;
			font-size: 20px;
			cursor: pointer;
			display: flex;
			align-items: center;
			justify-content: center;
			box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
		}

		.settings-modal {
			position: fixed;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			width: 500px;
			max-width: 90%;
			max-height: 80vh;
			background-color: #252526;
			border-radius: 8px;
			padding: 20px;
			box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
			z-index: 1000;
			display: none;
			overflow-y: auto;
		}

		.settings-modal h2 {
			color: #569cd6;
			margin-top: 0;
			border-bottom: 1px solid #333;
			padding-bottom: 10px;
		}

		.settings-modal .close-btn {
			position: absolute;
			top: 15px;
			right: 15px;
			background: none;
			border: none;
			color: #d4d4d4;
			font-size: 20px;
			cursor: pointer;
		}

		.settings-modal .form-group {
			margin-bottom: 15px;
		}

		.settings-modal label {
			display: block;
			margin-bottom: 5px;
			color: #d4d4d4;
		}

		.settings-modal select,
		.settings-modal input[type="number"] {
			width: 100%;
			padding: 8px;
			background-color: #3c3c3c;
			border: 1px solid #333;
			border-radius: 4px;
			color: #d4d4d4;
		}

		.settings-modal .form-row {
			display: flex;
			gap: 15px;
			margin-bottom: 15px;
		}

		.settings-modal .form-col {
			flex: 1;
		}

		.settings-modal .save-btn {
			background-color: #569cd6;
			color: white;
			border: none;
			padding: 10px 15px;
			border-radius: 4px;
			cursor: pointer;
			margin-top: 10px;
		}

		.settings-modal .save-btn:hover {
			background-color: #4d8bc5;
		}

		.modal-overlay {
			position: fixed;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background-color: rgba(0, 0, 0, 0.5);
			z-index: 999;
			display: none;
		}
	</style>
	<!-- å¼•å…¥ highlight.js -->
	<link rel="stylesheet" href="https://cdn.staticfile.net/highlight.js/11.7.0/styles/vs2015.min.css">
	<script src="https://cdn.staticfile.net/highlight.js/11.7.0/highlight.min.js"></script>
	<!-- å¼•å…¥ KaTeX -->
	<link rel="stylesheet" href="https://cdn.staticfile.net/KaTeX/0.16.8/katex.min.css">
	<script src="https://cdn.staticfile.net/KaTeX/0.16.8/katex.min.js"></script>
	<script defer src="https://cdn.staticfile.net/KaTeX/0.16.8/contrib/auto-render.min.js" crossorigin="anonymous"
		onload="renderMathInElement(document.body);"></script>
	<!-- å¼•å…¥ marked.js -->
	<script src="https://cdn.staticfile.net/marked/15.0.7/marked.min.js"></script>
	<script>
		// é…ç½® marked æ”¯æŒ KaTeX å’Œä»£ç é«˜äº®
		marked.setOptions({
			highlight: function (code, lang) {
				const language = hljs.getLanguage(lang) ? lang : 'plaintext';
				return hljs.highlight(code.text, { language }).value;
			},
			breaks: false,
			gfm: true,
			pedantic: false,
			smartLists: true,
			smartypants: false,
			xhtml: false
		});

		// è‡ªå®šä¹‰ marked æ¸²æŸ“å™¨ä»¥æ”¯æŒæ•°å­¦å…¬å¼
		const renderer = {
			code(code, infostring) {
				infostring = infostring || code.lang;
				// console.log(code, infostring);
				if (infostring === 'math') {
					return `<div class="math-block katex-display">${katex.renderToString(code.text, { throwOnError: false, displayMode: true })}</div>`;
				}
				let s = code.text;
				s = s.replaceAll('&', '&amp;');
				s = s.replaceAll('<', '&lt;');
				s = s.replaceAll('>', '&gt;');
				return `<pre><code>${s}</code></pre>`;
			}
		};

		marked.use({ renderer });
	</script>
</head>

<body>
	<div class="loader-overlay" id="loader" style="display: flex; opacity: 1;
		z-index: 100000000;">
		<div class="loader" style="
				display: flex;
				opacity: 1;
			"></div>
		<div class="loader" style="
				position: fixed;
				opacity: 1;
				width: 9.5em;
				height: 9.5em;
				opacity: 1 !important;
				background: #1e1e1e;
				box-shadow: inset 0 0 0.75em rgba(0, 0, 0, 0.1);
			"></div>
		<div style="
				position: fixed;
				opacity: 1;
				z-index:999999999;
			">loading...</div>
	</div>
	<script>
		function showLoader() {
			const loader = document.getElementById('loader');
			loader.style.display = 'flex';
			loader.style.opacity = '1';
		}

		function fadeOutLoader() {
			const loader = document.getElementById('loader');
			loader.style.opacity = '0';
			setTimeout(() => {
				loader.style.display = 'none';
			}, 500);
		}
		showLoader();

		window.myloader = { show: showLoader, hide: fadeOutLoader };
	</script>
	<div class="header">
		<div class="title">Monaco ä»£ç ç¼–è¾‘å™¨</div>
		<div class="controls">
			<select id="language-select">
				<option value="javascript">JavaScript</option>
				<option value="typescript">TypeScript</option>
				<option value="html">HTML</option>
				<option value="css">CSS</option>
				<option value="python">Python</option>
				<option value="java">Java</option>
				<option value="csharp">C#</option>
				<option value="cpp">C++</option>
				<option value="go">Go</option>
				<option value="rust">Rust</option>
				<option value="php">PHP</option>
				<option value="sql">SQL</option>
				<option value="json">JSON</option>
				<option value="xml">XML</option>
				<option value="markdown" selected>Markdown</option>
			</select>

			<div class="font-controls">
				<label for="font-family">å­—ä½“:</label>
				<select id="font-family">
					<option value="'Courier New', monospace">Courier New</option>
					<option value="'Consolas', monospace" selected>Consolas</option>
					<option value="'Fira Code', monospace">Fira Code</option>
					<option value="'Source Code Pro', monospace">Source Code Pro</option>
					<option value="'Roboto Mono', monospace">Roboto Mono</option>
				</select>
			</div>

			<div class="font-controls">
				<label for="font-size">å¤§å°:</label>
				<input type="number" id="font-size" min="8" max="32" value="14">
			</div>

			<div class="font-controls">
				<label for="tab-size">Tab:</label>
				<input type="number" id="tab-size" min="1" max="8" value="4">
			</div>

			<button id="run-btn">è¿è¡Œ (JS)</button>
			<button id="preview-btn">é¢„è§ˆ</button>
			<button id="save-btn">ä¿å­˜</button>
		</div>
	</div>

	<div class="editor-container">
		<div id="editor"></div>
		<div class="splitter" id="splitter"></div>
		<div id="preview"></div>
	</div>

	<div class="status-bar">
		<div id="cursor-position">è¡Œ: 1, åˆ—: 1</div>
		<div id="file-info">æœªä¿å­˜çš„æ–‡ä»¶</div>
	</div>

	<button class="theme-toggle" id="theme-toggle">ğŸŒ“</button>
	<button class="view-toggle" id="view-toggle">ğŸ‘ï¸</button>
	<button class="save-toggle" id="save-toggle">
		<svg t="1743583851192" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
			p-id="910">
			<path
				d="M874.1 336.92H150.31c-29.72 0-53.9 23.32-53.9 51.97v288.74c0 28.66 24.18 51.97 53.9 51.97h138.6v123.2H735.5V729.6h138.6c29.72 0 53.9-23.32 53.9-51.97V388.9c0-28.66-24.19-51.98-53.9-51.98zM689.3 806.61H335.11V560.22H689.3v246.39z m192.5-128.97c0 2.79-3.09 5.77-7.7 5.77H735.5v-123.2H774v-46.2H250.41v46.2h38.5v123.2h-138.6c-4.61 0-7.7-2.99-7.7-5.77V388.9c0-2.79 3.09-5.77 7.7-5.77H874.1c4.61 0 7.7 2.99 7.7 5.77v288.74zM335.11 144.43H689.3v169.39h46.2V98.23H288.91V314.9h46.2z"
				fill="#d4d4d4" p-id="911"></path>
			<path
				d="M412.11 637.22h200.2v46.2h-200.2zM373.61 714.21H650.8v46.2H373.61zM653.37 421.62h61.6v46.2h-61.6zM738.06 421.62h77v46.2h-77z"
				fill="#d4d4d4" p-id="912"></path>
		</svg>
	</button>
	<button class="help-toggle" id="help-toggle">?</button>
	<button class="settings-toggle" id="settings-toggle">âš™ï¸</button>

	<!-- æ–°å¢çš„è®¾ç½®æ¨¡æ€ -->
	<div class="modal-overlay" id="settings-overlay"></div>
	<div class="settings-modal" id="settings-modal">
		<button class="close-btn" id="close-settings">&times;</button>
		<h2>ç¼–è¾‘å™¨è®¾ç½®</h2>

		<div class="form-row">
			<div class="form-col">
				<div class="form-group">
					<label for="settings-theme">ä¸»é¢˜</label>
					<select id="settings-theme">
						<option value="vs-dark">æ·±è‰²</option>
						<option value="vs">æµ…è‰²</option>
						<option value="hc-black">é«˜å¯¹æ¯”åº¦</option>
					</select>
				</div>
			</div>
			<div class="form-col">
				<div class="form-group">
					<label for="settings-font-family">å­—ä½“</label>
					<select id="settings-font-family">
						<option value="'Courier New', monospace">Courier New</option>
						<option value="'Consolas', monospace" selected>Consolas</option>
						<option value="'Fira Code', monospace">Fira Code</option>
						<option value="'Source Code Pro', monospace">Source Code Pro</option>
						<option value="'Roboto Mono', monospace">Roboto Mono</option>
					</select>
				</div>
			</div>
		</div>

		<div class="form-row">
			<div class="form-col">
				<div class="form-group">
					<label for="settings-font-size">å­—ä½“å¤§å°</label>
					<input type="number" id="settings-font-size" min="8" max="32" value="14">
				</div>
			</div>
			<div class="form-col">
				<div class="form-group">
					<label for="settings-tab-size">Tabå¤§å°</label>
					<input type="number" id="settings-tab-size" min="1" max="8" value="4">
				</div>
			</div>
		</div>

		<div class="form-group">
			<label for="settings-line-numbers">è¡Œå·æ˜¾ç¤º</label>
			<select id="settings-line-numbers">
				<option value="on">æ˜¾ç¤º</option>
				<option value="off">éšè—</option>
				<option value="relative">ç›¸å¯¹è¡Œå·</option>
			</select>
		</div>

		<div class="form-group">
			<label for="settings-minimap">ç¼©ç•¥å›¾</label>
			<select id="settings-minimap">
				<option value="true">æ˜¾ç¤º</option>
				<option value="false">éšè—</option>
			</select>
		</div>

		<button class="save-btn" id="save-settings">ä¿å­˜è®¾ç½®</button>
	</div>

	<div class="help-panel" id="help-panel" style="display: none;">
		<h3>Markdown & KaTeX è¯­æ³•å¸®åŠ©</h3>

		<h4>åŸºç¡€æ ¼å¼</h4>
		<table>
			<tr>
				<th>è¯­æ³•</th>
				<th>æ•ˆæœ</th>
			</tr>
			<tr>
				<td><code># æ ‡é¢˜1</code></td>
				<td>ä¸€çº§æ ‡é¢˜</td>
			</tr>
			<tr>
				<td><code>## æ ‡é¢˜2</code></td>
				<td>äºŒçº§æ ‡é¢˜</td>
			</tr>
			<tr>
				<td><code>**ç²—ä½“**</code></td>
				<td><strong>ç²—ä½“</strong></td>
			</tr>
			<tr>
				<td><code>*æ–œä½“*</code></td>
				<td><em>æ–œä½“</em></td>
			</tr>
			<tr>
				<td><code>[é“¾æ¥](http://example.com)</code></td>
				<td><a href="#">é“¾æ¥</a></td>
			</tr>
			<tr>
				<td><code>![å›¾ç‰‡](image.png)</code></td>
				<td>å›¾ç‰‡</td>
			</tr>
		</table>

		<h4>åˆ—è¡¨</h4>
		<table>
			<tr>
				<th>è¯­æ³•</th>
				<th>æ•ˆæœ</th>
			</tr>
			<tr>
				<td><code>- æ— åºåˆ—è¡¨é¡¹</code></td>
				<td>â€¢ æ— åºåˆ—è¡¨é¡¹</td>
			</tr>
			<tr>
				<td><code>1. æœ‰åºåˆ—è¡¨é¡¹</code></td>
				<td>1. æœ‰åºåˆ—è¡¨é¡¹</td>
			</tr>
		</table>

		<h4>ä»£ç </h4>
		<table>
			<tr>
				<th>è¯­æ³•</th>
				<th>æ•ˆæœ</th>
			</tr>
			<tr>
				<td><code>```è¯­è¨€<br>ä»£ç å—<br>```</code></td>
				<td>è¯­æ³•é«˜äº®çš„ä»£ç å—</td>
			</tr>
			<tr>
				<td><code>`è¡Œå†…ä»£ç `</code></td>
				<td><code>è¡Œå†…ä»£ç </code></td>
			</tr>
		</table>

		<h4>KaTeX æ•°å­¦å…¬å¼</h4>
		<table>
			<tr>
				<th>è¯­æ³•</th>
				<th>æ•ˆæœ</th>
			</tr>
			<tr>
				<td><code>$è¡Œå†…å…¬å¼$</code></td>
				<td>è¡Œå†…æ•°å­¦å…¬å¼</td>
			</tr>
			<tr>
				<td><code>$$å—çº§å…¬å¼$$</code></td>
				<td>å•ç‹¬ä¸€è¡Œçš„æ•°å­¦å…¬å¼</td>
			</tr>
			<tr>
				<td><code>```math<br>å…¬å¼<br>```</code></td>
				<td>ä»£ç å—å½¢å¼çš„æ•°å­¦å…¬å¼</td>
			</tr>
		</table>

		<h4>å¸¸ç”¨æ•°å­¦ç¬¦å·</h4>
		<table>
			<tr>
				<th>è¯­æ³•</th>
				<th>ç¬¦å·</th>
			</tr>
			<tr>
				<td><code>\alpha</code></td>
				<td>Î±</td>
			</tr>
			<tr>
				<td><code>\beta</code></td>
				<td>Î²</td>
			</tr>
			<tr>
				<td><code>\sum</code></td>
				<td>âˆ‘</td>
			</tr>
			<tr>
				<td><code>\int</code></td>
				<td>âˆ«</td>
			</tr>
			<tr>
				<td><code>\frac{a}{b}</code></td>
				<td>åˆ†æ•° a/b</td>
			</tr>
			<tr>
				<td><code>\sqrt{x}</code></td>
				<td>âˆšx</td>
			</tr>
		</table>
	</div>

	<script>
		function setCookie(cname, cvalue, exdays) {
			var d = new Date();
			d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
			var expires = "expires=" + d.toGMTString();
			document.cookie = cname + "=" + cvalue + "; " + expires;
		}

		function getCookie(cname) {
			var name = cname + "=";
			var ca = document.cookie.split(';');
			for (var i = 0; i < ca.length; i++) {
				var c = ca[i].trim();
				if (c.indexOf(name) == 0) { return c.substring(name.length, c.length); }
			}
			return null;
		}

		var savedtheme = getCookie("theme") || "vs-dark";
		setCookie("theme", savedtheme, 365);

		// åŠ è½½ Monaco Editor è„šæœ¬
		const loadMonacoScript = () => {
			return new Promise((resolve) => {
				const script = document.createElement('script');
				script.src = 'https://cdn.staticfile.net/monaco-editor/0.41.0/min/vs/loader.min.js';
				script.onload = () => {
					// é…ç½® Monaco Editor çš„è·¯å¾„
					require.config({ 'vs/nls': { availableLanguages: { '*': 'zh-cn' } }, paths: { vs: 'https://cdn.staticfile.net/monaco-editor/0.41.0/min/vs/' } });

					// åŠ è½½ editor æ ¸å¿ƒ
					require(['vs/editor/editor.main'], () => {
						resolve();
					});
				};
				document.body.appendChild(script);
			});
		};

		// åˆå§‹åŒ–ç¼–è¾‘å™¨
		const initEditor = async () => {
			await loadMonacoScript();

			// é»˜è®¤ä»£ç 
			const defaultCode = {
				'javascript': '// JavaScript ä»£ç ç¤ºä¾‹\nfunction greet(name) {\n  return `Hello, ${name}!`;\n}\n\nconsole.log(greet("World"));',
				'typescript': '// TypeScript ä»£ç ç¤ºä¾‹\nfunction greet(name: string): string {\n  return `Hello, ${name}!`;\n}\n\nconsole.log(greet("World"));',
				'html': '<!DOCTYPE html>\n<html>\n<head>\n  <title>HTML é¢„è§ˆç¤ºä¾‹</title>\n  <style>\n    body {\n      font-family: Arial, sans-serif;\n      margin: 0;\n      padding: 20px;\n      background-color: #f5f5f5;\n    }\n    h1 {\n      color: #333;\n    }\n    .container {\n      max-width: 800px;\n      margin: 0 auto;\n      background: white;\n      padding: 20px;\n      border-radius: 5px;\n      box-shadow: 0 2px 5px rgba(0,0,0,0.1);\n    }\n  </style>\n</head>\n<body>\n  <div class="container">\n    <h1>HTML é¢„è§ˆåŠŸèƒ½</h1>\n    <p>ç¼–è¾‘å·¦ä¾§çš„HTMLä»£ç ï¼Œå³ä¾§ä¼šå®æ—¶æ˜¾ç¤ºé¢„è§ˆæ•ˆæœã€‚</p>\n    <p>è¯•è¯•ä¿®æ”¹è¿™æ®µæ–‡å­—çœ‹çœ‹æ•ˆæœï¼</p>\n  </div>\n</body>\n</html>',
				'css': '/* CSS ä»£ç ç¤ºä¾‹ */\nbody {\n  font-family: Arial, sans-serif;\n  margin: 0;\n  padding: 20px;\n  background-color: #f5f5f5;\n}\n\nh1 {\n  color: #333;\n}',
				'python': '# Python ä»£ç ç¤ºä¾‹\ndef greet(name):\n    return f"Hello, {name}!"\n\nprint(greet("World"))',
				'java': '// Java ä»£ç ç¤ºä¾‹\npublic class Main {\n    public static void main(String[] args) {\n        System.out.println("Hello World!");\n    }\n}',
				'csharp': '// C# ä»£ç ç¤ºä¾‹\nusing System;\n\nclass Program {\n    static void Main() {\n        Console.WriteLine("Hello World!");\n    }\n}',
				'cpp': '// C++ ä»£ç ç¤ºä¾‹\n#include <iostream>\n\nint main() {\n\tstd::cout << "Hello World!" << std::endl;\n\treturn 0;\n}',
				'go': '// Go ä»£ç ç¤ºä¾‹\npackage main\n\nimport "fmt"\n\nfunc main() {\n    fmt.Println("Hello World!");\n}',
				'rust': '// Rust ä»£ç ç¤ºä¾‹\nfn main() {\n    println!("Hello World!");\n}',
				'php': '<?php\n// PHP ä»£ç ç¤ºä¾‹\nfunction greet($name) {\n    return "Hello, $name!";\n}\n\necho greet("World");\n?>',
				'sql': '-- SQL ä»£ç ç¤ºä¾‹\nSELECT * FROM users WHERE age > 18 ORDER BY name ASC;',
				'json': '{\n  "name": "John Doe",\n  "age": 30,\n  "isActive": true,\n  "address": {\n    "street": "123 Main St",\n    "city": "New York"\n  },\n  "hobbies": ["reading", "hiking"]\n}',
				'xml': '<!-- XML ä»£ç ç¤ºä¾‹ -->\n<person>\n  <name>John Doe</name>\n  <age>30</age>\n  <address>\n    <street>123 Main St</street>\n    <city>New York</city>\n  </address>\n</person>',
				'markdown': '# Markdown ç¤ºä¾‹\n\nè¿™æ˜¯ä¸€ä¸ª **Markdown** æ–‡æ¡£ç¤ºä¾‹ã€‚\n\n## æ•°å­¦å…¬å¼\n\nè¡Œå†…å…¬å¼: $E = mc^2$\n\nå—çº§å…¬å¼:\n\n$$\n\\int_a^b f(x) dx = F(b) - F(a)\n$$\n\næˆ–è€…:\n\n```math\n\\sum_{i=1}^n i = \\frac{n(n+1)}{2}\n```\n\n## ä»£ç ç¤ºä¾‹\n\n```javascript\n// JavaScript ä»£ç å—\nfunction hello() {\n  console.log("Hello World!");\n}\n```\n\n## å…¶ä»–å…ƒç´ \n\n- åˆ—è¡¨é¡¹ 1\n- åˆ—è¡¨é¡¹ 2\n\n[é“¾æ¥](https://example.com)\n\n> å¼•ç”¨å†…å®¹ç¤ºä¾‹\n\n| è¡¨æ ¼ç¤ºä¾‹ | ç¬¬äºŒåˆ— |\n|----------|--------|\n| è¡Œ1      | æ•°æ®1  |\n| è¡Œ2      | æ•°æ®2  |'
			};

			// åˆ›å»ºç¼–è¾‘å™¨
			const editor = monaco.editor.create(document.getElementById('editor'), {
				value: defaultCode['markdown'],
				language: 'markdown',
				theme: savedtheme,
				automaticLayout: true,
				minimap: { enabled: true },
				fontSize: 14,
				fontFamily: "'Consolas', monospace",
				lineNumbers: 'on',
				roundedSelection: true,
				scrollBeyondLastLine: false,
				readOnly: false,
				renderWhitespace: 'selection',
				tabSize: 4
			});
			editor.getModel().updateOptions({ tabSize: 4 });

			// è·å–é¢„è§ˆå…ƒç´ 
			const preview = document.getElementById('preview');

			// æ›´æ–°é¢„è§ˆ
			const updatePreview = () => {
				const language = document.getElementById('language-select').value;
				const content = editor.getValue();

				if (language === 'html') {
					// åˆ›å»ºiframeæ¥å®‰å…¨é¢„è§ˆHTML
					const iframe = document.createElement('iframe');
					iframe.style.width = '100%';
					iframe.style.height = '100%';
					iframe.style.border = 'none';
					iframe.srcdoc = content;

					// æ¸…ç©ºé¢„è§ˆåŒºåŸŸå¹¶æ·»åŠ iframe
					preview.innerHTML = '';
					preview.appendChild(iframe);
				} else if (language === 'markdown') {
					// ä½¿ç”¨marked.jsæ¸²æŸ“Markdown
					preview.innerHTML = marked.parse(content);

					// æ¸²æŸ“å®Œæˆåï¼Œé«˜äº®æ‰€æœ‰ä»£ç å—
					document.querySelectorAll('pre code').forEach((block) => {
						if (!block.classList.contains('language-math')) {
							hljs.highlightElement(block);
						}
					});

					// å¤„ç†æ•°å­¦å…¬å¼
					renderMathInElement(document.getElementById("preview"), {
						delimiters: [
							{ left: '$$', right: '$$', display: true },
							{ left: '$', right: '$', display: false }
						],
						throwOnError: true
					});
				} else {
					preview.innerHTML = '<p>é¢„è§ˆåŠŸèƒ½ä»…æ”¯æŒHTMLå’ŒMarkdown</p>';
				}
			};

			// åˆå§‹åŒ–é¢„è§ˆ
			updatePreview();

			// æ›´æ–°å…‰æ ‡ä½ç½®æ˜¾ç¤º
			editor.onDidChangeCursorPosition((e) => {
				document.getElementById('cursor-position').textContent =
					`è¡Œ: ${e.position.lineNumber}, åˆ—: ${e.position.column}`;
			});

			// è¯­è¨€é€‰æ‹©å™¨
			const languageSelect = document.getElementById('language-select');
			languageSelect.addEventListener('change', () => {
				const language = languageSelect.value;
				monaco.editor.setModelLanguage(editor.getModel(), language);
				editor.setValue(defaultCode[language] || `// ${language} ä»£ç `);

				// å¦‚æœæ˜¯HTMLæˆ–Markdownè¯­è¨€ï¼Œæ˜¾ç¤ºé¢„è§ˆé¢æ¿
				if (language === 'html' || language === 'markdown') {
					document.getElementById('editor').style.width = "50%";
					document.getElementById('preview').style.display = 'block';
					document.getElementById('splitter').style.display = 'block';
					updatePreview();
				} else {
					document.getElementById('editor').style.width = "100%";
					document.getElementById('preview').style.display = 'none';
					document.getElementById('splitter').style.display = 'none';
				}
			});

			// è¿è¡ŒæŒ‰é’® (ä»…å¯¹JavaScriptæœ‰æ•ˆ)
			document.getElementById('run-btn').addEventListener('click', () => {
				if (languageSelect.value === 'javascript') {
					try {
						// ä½¿ç”¨evalè¿è¡Œä»£ç  (ä»…ç”¨äºæ¼”ç¤ºï¼Œç”Ÿäº§ç¯å¢ƒåº”æ›´å®‰å…¨åœ°å¤„ç†)
						eval(editor.getValue());
					} catch (error) {
						console.error(error);
						alert(`æ‰§è¡Œé”™è¯¯: ${error.message}`);
					}
				} else {
					alert('è¿è¡ŒåŠŸèƒ½ä»…æ”¯æŒJavaScriptä»£ç ');
				}
			});

			// é¢„è§ˆæŒ‰é’®
			document.getElementById('preview-btn').addEventListener('click', () => {
				const language = languageSelect.value;
				if (language === 'html' || language === 'markdown') {
					const preview = document.getElementById('preview');
					if (preview.style.display !== 'none')
						updatePreview();
				} else {
					alert('é¢„è§ˆåŠŸèƒ½ä»…æ”¯æŒHTMLå’ŒMarkdownä»£ç ');
				}
			});

			// ä¿å­˜æŒ‰é’®
			document.getElementById('save-btn').addEventListener('click', () => {
				const blob = new Blob([editor.getValue()], { type: 'text/plain' });
				const url = URL.createObjectURL(blob);
				const a = document.createElement('a');
				a.href = url;
				a.download = `code.${languageSelect.value}`;
				document.body.appendChild(a);
				a.click();
				document.body.removeChild(a);
				URL.revokeObjectURL(url);

				document.getElementById('file-info').textContent = `å·²ä¿å­˜: code.${languageSelect.value}`;
				setTimeout(() => {
					document.getElementById('file-info').textContent = 'æœªä¿å­˜çš„æ–‡ä»¶';
				}, 3000);
			});

			// ä¸»é¢˜åˆ‡æ¢
			let isDarkTheme = savedtheme == 'vs-dark';
			document.getElementById('theme-toggle').textContent = isDarkTheme ? 'ğŸŒ“' : 'ğŸŒ’';
			document.getElementById('theme-toggle').addEventListener('click', () => {
				isDarkTheme = !isDarkTheme;
				monaco.editor.setTheme(isDarkTheme ? 'vs-dark' : 'vs');
				savedtheme = isDarkTheme ? 'vs-dark' : 'vs';
				setCookie("theme", savedtheme, 365);
				console.log(getCookie("theme"));
				document.getElementById('theme-toggle').textContent = isDarkTheme ? 'ğŸŒ“' : 'ğŸŒ’';
			});

			// è§†å›¾åˆ‡æ¢
			document.getElementById('view-toggle').addEventListener('click', () => {
				const preview = document.getElementById('preview');
				const splitter = document.getElementById('splitter');
				if (preview.style.display === 'none') {
					preview.style.display = 'block';
					splitter.style.display = 'block';
					document.getElementById('editor').style.width = "50%";
				} else {
					preview.style.display = 'none';
					splitter.style.display = 'none';
					document.getElementById('editor').style.width = "100%";
				}
			});

			// æ–°å¢çš„è®¾ç½®æ¨¡æ€åŠŸèƒ½
			const settingsModal = document.getElementById('settings-modal');
			const settingsOverlay = document.getElementById('settings-overlay');
			const settingsToggle = document.getElementById('settings-toggle');
			const closeSettings = document.getElementById('close-settings');
			const saveSettings = document.getElementById('save-settings');

			// æ‰“å¼€è®¾ç½®æ¨¡æ€
			settingsToggle.addEventListener('click', () => {
				// åŠ è½½å½“å‰è®¾ç½®åˆ°æ¨¡æ€ä¸­
				document.getElementById('settings-theme').value = savedtheme;
				document.getElementById('settings-font-family').value = editor.getOption(monaco.editor.EditorOption.fontFamily);
				document.getElementById('settings-font-size').value = editor.getOption(monaco.editor.EditorOption.fontSize);
				document.getElementById('settings-tab-size').value = editor.getModel().getOptions().tabSize;
				document.getElementById('settings-line-numbers').value = editor.getOption(monaco.editor.EditorOption.lineNumbers);
				document.getElementById('settings-minimap').value = editor.getOption(monaco.editor.EditorOption.minimap).enabled ? 'true' : 'false';

				settingsModal.style.display = 'block';
				settingsOverlay.style.display = 'block';
			});

			// å…³é—­è®¾ç½®æ¨¡æ€
			closeSettings.addEventListener('click', () => {
				settingsModal.style.display = 'none';
				settingsOverlay.style.display = 'none';
			});

			// ç‚¹å‡»é®ç½©å±‚å…³é—­è®¾ç½®æ¨¡æ€
			settingsOverlay.addEventListener('click', () => {
				settingsModal.style.display = 'none';
				settingsOverlay.style.display = 'none';
			});

			// ä¿å­˜è®¾ç½®
			saveSettings.addEventListener('click', () => {
				const newTheme = document.getElementById('settings-theme').value;
				const newFontFamily = document.getElementById('settings-font-family').value;
				const newFontSize = parseInt(document.getElementById('settings-font-size').value);
				const newTabSize = parseInt(document.getElementById('settings-tab-size').value);
				const newLineNumbers = document.getElementById('settings-line-numbers').value;
				const newMinimap = document.getElementById('settings-minimap').value === 'true';

				// åº”ç”¨æ–°è®¾ç½®
				monaco.editor.setTheme(newTheme);
				editor.updateOptions({
					fontFamily: newFontFamily,
					fontSize: newFontSize,
					lineNumbers: newLineNumbers,
					minimap: { enabled: newMinimap }
				});
				editor.getModel().updateOptions({ tabSize: newTabSize });

				// æ›´æ–°cookie
				savedtheme = newTheme;
				setCookie("theme", savedtheme, 365);

				// å…³é—­æ¨¡æ€
				settingsModal.style.display = 'none';
				settingsOverlay.style.display = 'none';

				// æ›´æ–°ä¸»é¢˜åˆ‡æ¢æŒ‰é’®
				document.getElementById('theme-toggle').textContent = newTheme === 'vs-dark' ? 'ğŸŒ“' : 'ğŸŒ’';
			});

			function openNewTabWithContent(content, title = "æ–°é¡µé¢") {
				const newWindow = window.open("", "_blank");
				newWindow.document.write(`
    <!DOCTYPE html>
    <html>
		<head>
		<title>${title}</title>
		<style>
			.hljs.language-html::before,.hljs.language-xml::before {content: "HTML/XML"}.hljs.language-javascript::before {content: "JavaScript"}.hljs.language-c::before {content: "C"}.hljs.language-cpp::before {content: "C++"}.hljs.language-java::before {content: "Java"}.hljs.language-asp::before {content: "ASP"}.hljs.language-actionscript::before {content: "ActionScript/Flash/Flex"}.hljs.language-bash::before {content: "Bash"}.hljs.language-css::before {content: "CSS"}.hljs.language-asp::before {content: "ASP"}.hljs.language-cs::before,.hljs.language-csharp::before {content: "C#"}.hljs.language-d::before {content: "D"}.hljs.language-golang::before,.hljs.language-go::before {content: "Go"}.hljs.language-json::before {content: "JSON"}.hljs.language-lua::before {content: "Lua"}.hljs.language-less::before {content: "LESS"}.hljs.language-md::before,.hljs.language-markdown::before,.hljs.language-mkdown::before,.hljs.language-mkd::before {content: "Markdown"}.hljs.language-mm::before,.hljs.language-objc::before,.hljs.language-obj-c::before,.hljs.language-objective-c::before {content: "Objective-C"}.hljs.language-php::before {content: "PHP"}.hljs.language-perl::before,.hljs.language-pl::before,.hljs.language-pm::before {content: "Perl"}.hljs.language-python::before,.hljs.language-py::before,.hljs.language-gyp::before,.hljs.language-ipython::before {content: "Python"}.hljs.language-r::before {content: "R"}.hljs.language-ruby::before,.hljs.language-rb::before,.hljs.language-gemspec::before,.hljs.language-podspec::before,.hljs.language-thor::before,.hljs.language-irb::before {content: "Ruby"}.hljs.language-sql::before {content: "SQL"}.hljs.language-sh::before,.hljs.language-shell::before,.hljs.language-Session::before,.hljs.language-shellsession::before,.hljs.language-console::before {content: "Shell"}.hljs.language-swift::before {content: "Swift"}.hljs.language-vb::before {content: "VB/VBScript"}.hljs.language-yaml::before {content: "YAML"}.hljs,.math-block {border-radius: 1em;position: relative;display: block;overflow-x: hidden;color: #d4d4d4;padding-top: 30px !important;box-shadow: 0 10px 30px 0px rgb(0 0 0 / 40%)}body .math-block::before {content: "Math"}.hljs::before,.math-block::before {content: "";position: absolute;left: 15px;top: 10px;overflow: visible;width: 12px;height: 12px;border-radius: 16px;box-shadow: 20px 0 #fdbc40, 40px 0 #35cd4b;-webkit-box-shadow: 20px 0 #fdbc40, 40px 0 #35cd4b;background-color: #fc625d;white-space: nowrap;text-indent: 75px;font-size: 16px;line-height: 12px;font-weight: 700;}body {margin: 0;padding: 0;font-family: Arial, sans-serif;display: flex;flex-direction: column;height: 100vh;overflow: hidden;background-color: #1e1e1e;color: #d4d4d4;}body {height: 100%;border: none;background-color: #1e1e1e;padding: 20px;overflow: auto;box-sizing: border-box;color: #d4d4d4;}/* Markdown é¢„è§ˆæ ·å¼ - æš—è‰²ä¸»é¢˜ */body h1,body h2,body h3,body h4,body h5,body h6 {margin-top: 1em;margin-bottom: 0.5em;font-weight: bold;color: #d4d4d4;}body h1 {font-size: 2em;border-bottom: 1px solid #333;color: #569cd6;}body h2 {font-size: 1.5em;border-bottom: 1px solid #333;color: #4ec9b0;}body h3 {font-size: 1.25em;color: #c586c0;}body h4 {font-size: 1em;color: #9cdcfe;}body h5 {font-size: 0.875em;color: #ce9178;}body h6 {font-size: 0.85em;color: #858585;}body p {margin: 0 0 1em;color: #d4d4d4;}body ul,body ol {margin: 0 0 1em 2em;padding: 0;color: #d4d4d4;}body li {margin: 0.25em 0;color: #d4d4d4;}body blockquote {margin: 0 0 1em;padding: 0 1em;border-left: 4px solid #6a9955;color: #d4d4d4;background-color: #252526;}body blockquote p {margin: 0;}body pre code,.math-block {background-color: #252526;padding: 1em;border-radius: 3px;overflow: auto;border: 1px solid #333;}body code,.math-block {font-family: Consolas, Monaco, monospace;background-color: #252526;padding: 0.2em 0.4em;border-radius: 3px;color: #d4d4d4;}body a {color: #569cd6;text-decoration: none;}body a:hover {text-decoration: underline;}body img {max-width: 100%;background-color: white;padding: 5px;border-radius: 3px;}body table {border-collapse: collapse;margin: 1em 0;width: 100%;}body th,body td {border: 1px solid #333;padding: 0.5em 1em;color: #d4d4d4;}body th {background-color: #252526;font-weight: bold;}body tr:nth-child(even) {background-color: #252526;}/* KaTeX å…¬å¼æ ·å¼ */.katex {font-size: 1.1em !important;color: #d4d4d4 !important;}/* æ•°å­¦å…¬å¼å—æ ·å¼ */.math-block {text-align: center;margin: 1em 0;padding: 0.5em;background-color: #252526;border-radius: 3px;overflow-x: auto;}/* Highlight.js ä¸»é¢˜ - ç±»ä¼¼ VS Code æš—è‰²ä¸»é¢˜ */.hljs,.math-block {display: block;overflow-x: auto;padding: 0.5em;background: #252526;border-radius: 3px;color: #d4d4d4;}.hljs-keyword,.hljs-literal,.hljs-name,.hljs-symbol {color: #569cd6;}.hljs-link {color: #569cd6;text-decoration: underline;}.hljs-built_in,.hljs-type {color: #4ec9b0;}.hljs-number,.hljs-class {color: #b5cea8;}.hljs-string,.hljs-meta-string {color: #ce9178;}.hljs-regexp,.hljs-template-tag {color: #9a5334;}.hljs-subst,.hljs-function,.hljs-title,.hljs-params,.hljs-formula {color: #dcdcaa;}.hljs-comment,.hljs-quote {color: #6a9955;font-style: italic;}.hljs-doctag {color: #608b4e;}.hljs-meta,.hljs-meta-keyword,.hljs-tag {color: #9b9b9b;}.hljs-variable,.hljs-template-variable {color: #bd63c5;}.hljs-attr,.hljs-attribute,.hljs-builtin-name {color: #9cdcfe;}.hljs-section {color: gold;}.hljs-emphasis {font-style: italic;}.hljs-strong {font-weight: bold;}.hljs-bullet,.hljs-selector-tag,.hljs-selector-id,.hljs-selector-class,.hljs-selector-attr,.hljs-selector-pseudo {color: #d7ba7d;}.hljs-addition {background-color: #144212;display: inline-block;width: 100%;}.hljs-deletion {background-color: #600;display: inline-block;width: 100%;}
		</style>
		<link rel="stylesheet" href="https://cdn.staticfile.net/KaTeX/0.16.8/katex.min.css">
		</head>
		<body>
		${content}
		</body>
    </html>
  `);
				return newWindow;
			}

			document.getElementById('save-toggle').addEventListener('click', () => {
				const language = document.getElementById('language-select').value;
				const content = editor.getValue();
				// ä½¿ç”¨marked.jsæ¸²æŸ“Markdown
				let p = openNewTabWithContent(marked.parse(content));

				// æ¸²æŸ“å®Œæˆåï¼Œé«˜äº®æ‰€æœ‰ä»£ç å—
				p.document.querySelectorAll('pre code').forEach((block) => {
					if (!block.classList.contains('language-math')) {
						hljs.highlightElement(block);
					}
				});

				// å¤„ç†æ•°å­¦å…¬å¼
				renderMathInElement(p.document.body, {
					delimiters: [
						{ left: '$$', right: '$$', display: true },
						{ left: '$', right: '$', display: false }
					],
					throwOnError: true
				});
				p.print();
				p.document.close();
			});

			// ç›‘å¬å†…å®¹å˜åŒ–
			editor.onDidChangeModelContent(() => {
				document.getElementById('file-info').textContent = 'æœªä¿å­˜çš„æ–‡ä»¶*';
				const language = languageSelect.value;
				if (language === 'html' || language === 'markdown') {
					updatePreview();
				}
			});

			// å­—ä½“è®¾ç½®
			const fontFamilySelect = document.getElementById('font-family');
			fontFamilySelect.addEventListener('change', () => {
				editor.updateOptions({ fontFamily: fontFamilySelect.value });
			});

			// å­—ä½“å¤§å°è®¾ç½®
			const fontSizeInput = document.getElementById('font-size');
			fontSizeInput.addEventListener('change', () => {
				const size = Math.min(32, Math.max(8, parseInt(fontSizeInput.value) || 14));
				fontSizeInput.value = size;
				editor.updateOptions({ fontSize: size });
			});

			// Tabå¤§å°è®¾ç½®
			const tabSizeInput = document.getElementById('tab-size');
			tabSizeInput.addEventListener('change', () => {
				const size = Math.min(8, Math.max(1, parseInt(tabSizeInput.value) || 2));
				tabSizeInput.value = size;
				editor.getModel().updateOptions({ tabSize: size });
			});

			// åˆ†å‰²æ¡æ‹–åŠ¨åŠŸèƒ½
			const splitter = document.getElementById('splitter');
			let isDragging = false;

			splitter.addEventListener('mousedown', (e) => {
				isDragging = true;
				document.body.style.cursor = 'col-resize';
				e.preventDefault();
			});

			document.addEventListener('mousemove', (e) => {
				if (!isDragging) return;

				const editorContainer = document.querySelector('.editor-container');
				const containerRect = editorContainer.getBoundingClientRect();
				const newEditorWidth = e.clientX - containerRect.left;
				const newPreviewWidth = containerRect.width - newEditorWidth - 5;

				if (newEditorWidth > 100 && newPreviewWidth > 100) {
					document.getElementById('editor').style.width = `${newEditorWidth}px`;
					document.getElementById('preview').style.width = `${newPreviewWidth}px`;
				}
			});

			// å¸®åŠ©é¢æ¿åˆ‡æ¢
			document.getElementById('help-toggle').addEventListener('click', () => {
				const helpPanel = document.getElementById('help-panel');
				helpPanel.style.display = helpPanel.style.display === 'block' ? 'none' : 'block';
			});

			// ç‚¹å‡»å…¶ä»–åœ°æ–¹å…³é—­å¸®åŠ©é¢æ¿
			document.addEventListener('click', (e) => {
				const helpPanel = document.getElementById('help-panel');
				const helpToggle = document.getElementById('help-toggle');

				if (e.target !== helpToggle && !helpPanel.contains(e.target)) {
					helpPanel.style.display = 'none';
				}
			});

			document.addEventListener('mouseup', () => {
				isDragging = false;
				document.body.style.cursor = '';
			});

			fadeOutLoader();
		};

		// åˆå§‹åŒ–åº”ç”¨
		document.addEventListener('DOMContentLoaded', initEditor);
	</script>
</body>

</html>